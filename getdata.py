#python scripts
__author__='Du Jiawei'
#Descrption:
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
import csv
train_path = "/data/home/dujw/weitao/data/train.csv"
train_label_path = "/data/home/dujw/weitao/data/train_label.csv"
test_path = "/data/home/dujw/weitao/data/test.csv"
def get_data(size = 50000,test_size=0.2):
    data = []
    Y = []
    count = -1
    label = pd.read_csv(train_label_path).as_matrix()
    with open(train_path, "rb") as csvfile:
        datareader = csv.reader(csvfile)
        for row in datareader:
            count += 1
            row = np.array(row)
            if len(row)!=1024:
                continue
            if count < size:
                data.append(row)
                Y.append(label[count,1])
            if count >=size:
                break
    X = np.array(data)
    Y = np.array(Y)
    x_train ,x_test, y_train,y_test = train_test_split(X,Y,test_size=test_size,random_state=42)
    return (x_train.astype(np.float32), y_train.astype(np.int8)),(x_test.astype(np.float32), y_test.astype(np.int8))


   
if __name__ == '__main__':
    x,t = get_data(size = 3000000)
    import pdb
    pdb.set_trace()
    

